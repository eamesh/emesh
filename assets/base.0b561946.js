import{F as r}from"./FormItem.03d633ee.js";import{T as x}from"./TitleDivider.a3e8ca71.js";import{U as M,a as T}from"./UploadVideo.386c3299.js";import{d as G,C as L,r as l,D as k,Q as h,j as q,M as w,f as u,Y as I,k as s,es as V}from"./index.78c09cee.js";import{N as _}from"./a.4fd84402.js";import{u as j,c as O}from"./goods.a25341f2.js";import{l as S}from"./group.455a86c7.js";import{_ as K}from"./DynamicTags.33a4a9b7.js";import{N as F}from"./text.70ab020c.js";import{_ as E}from"./Input.d62ae2d3.js";import{N as P}from"./Space.df1d9265.js";import{N as Q}from"./Select.d28ef4cc.js";import{N as Y}from"./Divider.b4cc6bcb.js";import{_ as z}from"./index.c8e95861.js";import"./index.c7bfc907.js";import"./vue.runtime.esm-bundler.831b3aa7.js";import"./on-fonts-ready.ae35f6df.js";import"./use-merged-state.c2667ee5.js";import"./use-compitable.3d828e2e.js";import"./use-breakpoints.4d1d91ba.js";import"./use-keyboard.56e3994d.js";import"./index.31a54536.js";import"./next-frame-once.3f36dc6b.js";import"./happens-in.f44eb706.js";import"./responsive.3b03a350.js";import"./get.05c76103.js";import"./Image.74f11219.js";import"./light.4ca07ad7.js";import"./use-locale.c29a83eb.js";import"./Tooltip.32e62f75.js";import"./Tag.9b989cfb.js";import"./Follower.d919f920.js";import"./cssr.7e31f5cb.js";import"./light.8df066b9.js";import"./Menu.c43a6a15.js";import"./Dropdown.27fcf2f4.js";import"./index.a288f029.js";import"./ChevronRight.f56fbeda.js";import"./interface.08cd48a1.js";import"./Grid.2d03393b.js";import"./index.8c3a953a.js";import"./VirtualList.02b97eb1.js";import"./utils.660e96e0.js";import"./Upload.a9897365.js";import"./Add.ad5e1d51.js";import"./FormItem.e60f1735.js";import"./RadioGroup.dac88e26.js";import"./Pagination.6db75b25.js";import"./Forward.2f76308d.js";import"./light.d72ed5cc.js";import"./light.e6bd6d56.js";var Qe=G({name:"FormBase",setup(){const{goodsModel:i}=j(),n=L(O),o=l({type:"entity",name:"",description:"",introduction:"",group_ids:[],images:[],video:""}),p=l(),m=l(!1),d=l([]),t=l(!1),c=l([]),f=l([]),B=k(()=>d.value.map(e=>({value:e.id,label:e.name})));h(()=>i.value,b,{deep:!0});function b(){const e=q(i);g(),o.value={type:o.value.type,name:e.name,description:e.description,introduction:e.introduction,group_ids:e.groups.map(a=>a.id),images:e.images,video:e.video},D(),R()}function D(){const e=i.value.images;e.length&&(c.value=e.map((a,v)=>({id:v.toString(),name:"",status:"finished",url:a,thumbnailUrl:a}))),console.log("update images",c.value)}function R(){const e=i.value.video;e&&(f.value=[{id:"1",name:"",status:"finished",url:e,thumbnailUrl:e}]),console.log("update video",f.value)}h(()=>c.value,e=>{A(e)}),h(()=>f.value,e=>{C(e)});const U={name:{required:!0,message:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0"},images:{required:!0,message:"\u8BF7\u4E0A\u4F20\u5546\u54C1\u56FE"},description:{max:36,message:"\u8BF7\u6309\u8981\u6C42\u586B\u5199\u63CF\u8FF0"},introduction:{max:100,required:!0,message:"\u8BF7\u6309\u8981\u6C42\u586B\u5199\u5546\u54C1\u5356\u70B9"},group_ids:{type:"array",required:!0,min:1,trigger:"change",message:"\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7EC4"}};function A(e){o.value.images=e.map(a=>a.thumbnailUrl),console.log(o.value.images)}function C(e){e.length&&(o.value.video=e[0].thumbnailUrl),console.log(o.value.video)}function g(){return m.value=!0,new Promise(async(e,a)=>{try{d.value=await S(),e(!0)}catch(v){a(v)}m.value=!1})}function y(){!t.value&&g(),t.value=!0}function N(){return{type:"entity",name:o.value.name||"",description:o.value.description||"",introduction:o.value.introduction||"",group_ids:o.value.group_ids,images:o.value.images,video:o.value.video||""}}return w(()=>{n==null||n.setForm("base",p.value,N)}),{model:o,rules:U,formRef:p,imagesTmpRef:c,videoTmpRef:f,groupLoadingRef:m,groupOptions:B,handleChangeIMages:A,handleChangeVideo:C,loadGoodsGroup:g,handleGroupFocus:y}},render(){const{model:i,rules:n,groupLoadingRef:o,groupOptions:p,loadGoodsGroup:m,handleGroupFocus:d}=this;return u(z,{model:this.model,rules:n,ref:"formRef","label-placement":"left","label-width":"200px","require-mark-placement":"right-hanging",class:"form-model"},{default:()=>[u(x,{title:"\u57FA\u7840\u4FE1\u606F"},{default:()=>[u(r,{label:"\u5546\u54C1\u56FE:",path:"images"},{default:()=>u(M,{max:10,fileList:this.imagesTmpRef,"onUpdate:fileList":t=>this.imagesTmpRef=t},null),help:()=>u(I,null,[u(F,{depth:"3",tag:"div"},{default:()=>[s("\u7B2C\u4E00\u5F20\u56FE\u7247\u5C06\u4F5C\u4E3A\u5546\u54C1\u4E3B\u56FE,\u652F\u6301\u540C\u65F6\u4E0A\u4F20\u591A\u5F20\u56FE\u7247,\u591A\u5F20\u56FE\u7247\u4E4B\u95F4\u53EF\u968F\u610F\u8C03\u6574\u4F4D\u7F6E\uFF1B")]}),u(F,{depth:"3",tag:"div"},{default:()=>[s("\u652F\u6301jpg\u3001gif\u3001png\u683C\u5F0F\u4E0A\u4F20\u6216\u4ECE\u56FE\u7247\u7A7A\u95F4\u4E2D\u9009\u62E9\uFF0C\u5EFA\u8BAE\u4F7F\u7528\u5C3A\u5BF8800x800\u50CF\u7D20\u4EE5\u4E0A\u3001\u5927\u5C0F\u4E0D\u8D85\u8FC71M\u7684\u6B63\u65B9\u5F62\u56FE\u7247\uFF1B")]}),u(F,{depth:"3",tag:"div"},{default:()=>[s("\u4E0A\u4F20\u540E\u7684\u56FE\u7247\u5C06\u4F1A\u81EA\u52A8\u4FDD\u5B58\u5728\u56FE\u7247\u7A7A\u95F4\u7684\u9ED8\u8BA4\u5206\u7C7B\u4E2D\uFF0C\u6700\u591A\u4E0A\u4F2010\u5F20\uFF08\u81F3\u5C111\u5F20\uFF09")]})])}),u(r,{label:"\u4E3B\u56FE\u89C6\u9891:",path:"video",class:"form-mid"},{default:()=>[u(T,{fileList:this.videoTmpRef,"onUpdate:fileList":t=>this.videoTmpRef=t,max:1},null)]}),u(r,{label:"\u5546\u54C1\u540D:",path:"name",class:"form-mid"},{default:()=>[u(E,{value:i.name,"onUpdate:value":t=>i.name=t,placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0\uFF0C\u4E0D\u80FD\u8D85\u8FC760\u4E2A\u5B57\u7B26"},null)]}),u(r,{label:"\u5206\u4EAB\u63CF\u8FF0:",path:"description",class:"form-mid"},{default:()=>u(E,{value:this.model.description,"onUpdate:value":t=>this.model.description=t,placeholder:"\u8BF7\u8F93\u5165\u5206\u4EAB\u63CF\u8FF0\uFF0C\u4E0D\u80FD\u8D85\u8FC730\u4E2A\u5B57\u7B26"},null),help:()=>u(F,{depth:3},{default:()=>[s("\u5FAE\u4FE1\u5206\u4EAB\u7ED9\u597D\u53CB\u65F6\u4F1A\u663E\u793A\uFF0C\u5EFA\u8BAE36\u4E2A\u5B57\u4EE5\u5185")]})}),u(r,{label:"\u5546\u54C1\u5356\u70B9:",path:"introduction",class:"form-mid"},{default:()=>[u(E,{value:this.model.introduction,"onUpdate:value":t=>this.model.introduction=t,placeholder:"\u8BF7\u8F93\u5165\u4FC3\u9500\u8BED\uFF0C\u4E0D\u80FD\u8D85\u8FC7100\u4E2A\u5B57\u7B26"},null)]}),u(r,{label:"\u5173\u952E\u8BCD:",path:"tags",class:"form-long"},{default:()=>[u(K,null,null)]}),u(r,{label:"\u5546\u54C1\u5206\u7EC4:",path:"group_ids"},{default:()=>[u(P,{align:"center"},{default:()=>[u(Q,{multiple:!0,filterable:!0,placeholder:"\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7EC4",clearable:!0,remote:!0,"clear-filter-after-select":!1,style:"width: 250px;",loading:o,options:p,onFocus:d,value:this.model.group_ids,"onUpdate:value":t=>this.model.group_ids=t},null),u("div",null,[u(V,{to:"/mall/group",custom:!0},{default:()=>[u(_,{target:"_blank"},{default:()=>[s("\u65B0\u5EFA")]})]}),u(Y,{vertical:!0},null),u(_,{onClick:m},{default:()=>[s("\u5237\u65B0")]})])]})]})]})]})}});export{Qe as default};
