import{r as ye,e as me,N as ge,p as re}from"./Tag.9b989cfb.js";import{d as I,m as s,B as X,C as _,D as v,r as T,R as Z,L as E,a8 as xe,az as te,cX as B,cT as Se,a9 as Ne,Y as Re,p as m,cY as ke,q as ee,F as N,G as oe,s as P,x as D,H as Pe,I as ie,cZ as Ke,Q as Ie,a1 as Y,T as K,V as Ce,c_ as De}from"./index.78c09cee.js";import{a as _e}from"./index.a288f029.js";import{C as $e}from"./ChevronRight.f56fbeda.js";import{h as ze}from"./happens-in.f44eb706.js";import{V as Ae,a as Te,b as Fe}from"./Follower.d919f920.js";import{u as Oe}from"./use-merged-state.c2667ee5.js";import{u as Me}from"./use-keyboard.56e3994d.js";function je(e){return t=>{t?e.value=t.$el:e.value=null}}var de=I({name:"DropdownDivider",props:{clsPrefix:{type:String,required:!0}},render(){return s("div",{class:`${this.clsPrefix}-dropdown-divider`})}});const J=X("n-dropdown-menu"),H=X("n-dropdown"),ne=X("n-dropdown-option");function Q(e,t){return e.type==="submenu"||e.type===void 0&&e[t]!==void 0}function Ee(e){return e.type==="group"}function ae(e){return e.type==="divider"}function Be(e){return e.type==="render"}var le=I({name:"DropdownOption",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null},placement:{type:String,default:"right-start"},props:Object},setup(e){const t=_(H),{hoverKeyRef:d,keyboardKeyRef:i,lastToggledSubmenuKeyRef:o,pendingKeyPathRef:u,activeKeyPathRef:p,animatedRef:f,mergedShowRef:w,renderLabelRef:b,renderIconRef:g,labelFieldRef:$,childrenFieldRef:F}=t,C=_(ne,null),z=_(J),O=v(()=>e.tmNode.rawNode),x=v(()=>{const{value:n}=F;return Q(e.tmNode.rawNode,n)}),L=v(()=>{const{disabled:n}=e.tmNode;return n}),U=v(()=>{if(!x.value)return!1;const{key:n,disabled:r}=e.tmNode;if(r)return!1;const{value:l}=d,{value:h}=i,{value:y}=o,{value:k}=u;return l!==null?k.includes(n):h!==null?k.includes(n)&&k[k.length-1]!==n:y!==null?k.includes(n):!1}),q=v(()=>i.value===null&&!f.value),G=_e(U,300,q),V=v(()=>!!(C!=null&&C.enteringSubmenuRef.value)),A=T(!1);Z(ne,{enteringSubmenuRef:A});function W(){A.value=!0}function M(){A.value=!1}function R(){const{parentKey:n,tmNode:r}=e;!w.value||(o.value=n,i.value=null,d.value=r.key)}function j(){const{tmNode:n}=e;!w.value||d.value!==n.key&&R()}function S(n){if(!w.value)return;const{relatedTarget:r}=n;r&&!ze({target:r},"dropdownOption")&&(d.value=null)}function a(){const{value:n}=x,{tmNode:r}=e;!w.value||!n&&!r.disabled&&(t.doSelect(r.key,r.rawNode),t.doUpdateShow(!1))}return{labelField:$,renderLabel:b,renderIcon:g,siblingHasIcon:z.showIconRef,siblingHasSubmenu:z.hasSubmenuRef,animated:f,mergedShowSubmenu:v(()=>G.value&&!V.value),rawNode:O,hasSubmenu:x,pending:E(()=>{const{value:n}=u,{key:r}=e.tmNode;return n.includes(r)}),childActive:E(()=>{const{value:n}=p,{key:r}=e.tmNode,l=n.findIndex(h=>r===h);return l===-1?!1:l<n.length-1}),active:E(()=>{const{value:n}=p,{key:r}=e.tmNode,l=n.findIndex(h=>r===h);return l===-1?!1:l===n.length-1}),mergedDisabled:L,handleClick:a,handleMouseMove:j,handleMouseEnter:R,handleMouseLeave:S,handleSubmenuBeforeEnter:W,handleSubmenuAfterEnter:M}},render(){var e;const{animated:t,rawNode:d,mergedShowSubmenu:i,clsPrefix:o,siblingHasIcon:u,siblingHasSubmenu:p,renderLabel:f,renderIcon:w,props:b}=this,g=i?s(se,{clsPrefix:o,tmNodes:this.tmNode.children,parentKey:this.tmNode.key}):null,$={class:[`${o}-dropdown-option-body`,this.pending&&`${o}-dropdown-option-body--pending`,this.active&&`${o}-dropdown-option-body--active`,this.childActive&&`${o}-dropdown-option-body--child-active`,this.mergedDisabled&&`${o}-dropdown-option-body--disabled`],onMousemove:this.handleMouseMove,onMouseenter:this.handleMouseEnter,onMouseleave:this.handleMouseLeave,onClick:this.handleClick};return s("div",{class:`${o}-dropdown-option`},s("div",te($,b),[s("div",{"data-dropdown-option":!0,class:[`${o}-dropdown-option-body__prefix`,u&&`${o}-dropdown-option-body__prefix--show-icon`]},[w?w(d):B(d.icon)]),s("div",{"data-dropdown-option":!0,class:`${o}-dropdown-option-body__label`},f?f(d):B((e=d[this.labelField])!==null&&e!==void 0?e:d.title)),s("div",{"data-dropdown-option":!0,class:[`${o}-dropdown-option-body__suffix`,p&&`${o}-dropdown-option-body__suffix--has-submenu`]},this.hasSubmenu?s(Se,null,{default:()=>s($e,null)}):null)]),this.hasSubmenu?s(Ae,null,{default:()=>[s(Te,null,{default:()=>s("div",{class:`${o}-dropdown-offset-container`},s(Fe,{show:this.mergedShowSubmenu,placement:this.placement,teleportDisabled:!0},{default:()=>s("div",{class:`${o}-dropdown-menu-wrapper`},t?s(xe,{onBeforeEnter:this.handleSubmenuBeforeEnter,onAfterEnter:this.handleSubmenuAfterEnter,name:"fade-in-scale-up-transition",appear:!0},{default:()=>g}):g)}))})]}):null)}}),He=I({name:"DropdownGroupHeader",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(){const{showIconRef:e,hasSubmenuRef:t}=_(J),{renderLabelRef:d,labelFieldRef:i}=_(H);return{labelField:i,showIcon:e,hasSubmenu:t,renderLabel:d}},render(){var e;const{clsPrefix:t,hasSubmenu:d,showIcon:i,renderLabel:o}=this,{rawNode:u}=this.tmNode;return s("div",{class:`${t}-dropdown-option`},s("div",{class:`${t}-dropdown-option-body ${t}-dropdown-option-body--group`},s("div",{"data-dropdown-option":!0,class:[`${t}-dropdown-option-body__prefix`,i&&`${t}-dropdown-option-body__prefix--show-icon`]},B(u.icon)),s("div",{class:`${t}-dropdown-option-body__label`,"data-dropdown-option":!0},o?o(u):B((e=u.title)!==null&&e!==void 0?e:u[this.labelField])),s("div",{class:[`${t}-dropdown-option-body__suffix`,d&&`${t}-dropdown-option-body__suffix--has-submenu`],"data-dropdown-option":!0})))}}),Le=I({name:"NDropdownGroup",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0},parentKey:{type:[String,Number],default:null}},render(){const{tmNode:e,parentKey:t,clsPrefix:d}=this,{children:i}=e;return s(Re,null,s(He,{clsPrefix:d,tmNode:e,key:e.key}),i==null?void 0:i.map(o=>ae(o.rawNode)?s(de,{clsPrefix:d,key:o.key}):o.isGroup?(Ne("dropdown","`group` node is not allowed to be put in `group` node."),null):s(le,{clsPrefix:d,tmNode:o,parentKey:t,key:o.key})))}}),Ue=I({name:"DropdownRenderOption",props:{tmNode:{type:Object,required:!0}},render(){const{rawNode:{render:e,props:t}}=this.tmNode;return s("div",t,[e==null?void 0:e()])}}),se=I({name:"DropdownMenu",props:{showArrow:Boolean,arrowStyle:[String,Object],clsPrefix:{type:String,required:!0},tmNodes:{type:Array,default:()=>[]},parentKey:{type:[String,Number],default:null}},setup(e){const{renderIconRef:t,childrenFieldRef:d}=_(H);Z(J,{showIconRef:v(()=>{const i=t.value;return e.tmNodes.some(o=>{var u;if(o.isGroup)return(u=o.children)===null||u===void 0?void 0:u.some(({rawNode:f})=>i?i(f):f.icon);const{rawNode:p}=o;return i?i(p):p.icon})}),hasSubmenuRef:v(()=>{const{value:i}=d;return e.tmNodes.some(o=>{var u;if(o.isGroup)return(u=o.children)===null||u===void 0?void 0:u.some(({rawNode:f})=>Q(f,i));const{rawNode:p}=o;return Q(p,i)})})})},render(){const{parentKey:e,clsPrefix:t}=this;return s("div",{class:`${t}-dropdown-menu`},this.tmNodes.map(d=>{const{rawNode:i}=d;return Be(i)?s(Ue,{tmNode:d,key:d.key}):ae(i)?s(de,{clsPrefix:t,key:d.key}):Ee(i)?s(Le,{clsPrefix:t,tmNode:d,parentKey:e,key:d.key}):s(le,{clsPrefix:t,tmNode:d,parentKey:e,key:d.key,props:i.props})}),this.showArrow?ye({clsPrefix:t,arrowStyle:this.arrowStyle}):null)}}),qe=m("dropdown-menu",`
 transform-origin: inherit;
 padding: var(--n-padding);
 background-color: var(--n-color);
 border-radius: var(--n-border-radius);
 box-shadow: var(--n-box-shadow);
 transition:
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
`,[ke(),m("dropdown-option",`
 position: relative;
 `,[ee("a",`
 text-decoration: none;
 color: inherit;
 `,[ee("&::before",`
 content: "";
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),m("dropdown-option-body",`
 display: flex;
 cursor: pointer;
 height: var(--n-option-height);
 line-height: var(--n-option-height);
 font-size: var(--n-font-size);
 color: var(--n-option-text-color);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 `,[N("pending",[oe("disabled",{color:"var(--n-option-text-color-hover)",backgroundColor:"var(--n-option-color-hover)"}),P("prefix, suffix",{color:"var(--n-option-text-color-hover)"})]),N("active",[oe("disabled",{color:"var(--n-option-text-color-active)",backgroundColor:"var(--n-option-color-active)"}),P("prefix, suffix",{color:"var(--n-option-text-color-active)"})]),N("disabled",{cursor:"not-allowed",opacity:"var(--n-option-opacity-disabled)"}),N("child-active",{color:"var(--n-option-text-color-child-active)"},[P("prefix, suffix",{color:"var(--n-option-text-color-child-active)"})]),N("group",{fontSize:"calc(var(--n-font-size) - 1px)",color:"var(--n-group-header-text-color)"},[P("prefix",{width:"calc(var(--n-option-prefix-width) / 2)"},[N("show-icon",{width:"calc(var(--n-option-icon-prefix-width) / 2)"})])]),P("prefix",`
 width: var(--n-option-prefix-width);
 display: flex;
 justify-content: center;
 align-items: center;
 color: var(--n-prefix-color);
 transition: color .3s var(--n-bezier);
 `,[N("show-icon",{width:"var(--n-option-icon-prefix-width)"}),m("icon",{fontSize:"var(--n-option-icon-size)"})]),P("label",{whiteSpace:"nowrap",flex:1}),P("suffix",`
 box-sizing: border-box;
 flex-grow: 0;
 flex-shrink: 0;
 display: flex;
 justify-content: flex-end;
 align-items: center;
 min-width: var(--n-option-suffix-width);
 padding: 0 8px;
 transition: color .3s var(--n-bezier);
 color: var(--n-suffix-color);
 `,[N("has-submenu",{width:"var(--n-option-icon-suffix-width)"}),m("icon",{fontSize:"var(--n-option-icon-size)"})]),m("dropdown-menu",{pointerEvents:"all"})]),m("dropdown-offset-container",`
 pointer-events: none;
 position: absolute;
 left: 0;
 right: 0;
 top: -4px;
 bottom: -4px;
 `)]),m("dropdown-divider",`
 transition: background-color .3s var(--n-bezier);
 background-color: var(--n-divider-color);
 height: 1px;
 margin: 4px 0;
 `),m("dropdown-menu-wrapper",`
 transform-origin: inherit;
 width: fit-content;
 `)]);const Ge={animated:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},size:{type:String,default:"medium"},inverted:Boolean,placement:{type:String,default:"bottom"},onSelect:[Function,Array],options:{type:Array,default:()=>[]},showArrow:Boolean,renderLabel:Function,renderIcon:Function,labelField:{type:String,default:"label"},keyField:{type:String,default:"key"},childrenField:{type:String,default:"children"},value:[String,Number]},Ve=Object.keys(re),We=Object.assign(Object.assign(Object.assign({},re),Ge),ie.props);var ro=I({name:"Dropdown",inheritAttrs:!1,props:We,setup(e){const t=T(!1),d=Oe(D(e,"show"),t),i=v(()=>{const{keyField:a,childrenField:n}=e;return me(e.options,{getKey(r){return r[a]},getDisabled(r){return r.disabled===!0},getIgnored(r){return r.type==="divider"||r.type==="render"},getChildren(r){return r[n]}})}),o=v(()=>i.value.treeNodes),u=T(null),p=T(null),f=T(null),w=v(()=>{var a,n,r;return(r=(n=(a=u.value)!==null&&a!==void 0?a:p.value)!==null&&n!==void 0?n:f.value)!==null&&r!==void 0?r:null}),b=v(()=>i.value.getPath(w.value).keyPath),g=v(()=>i.value.getPath(e.value).keyPath),$=E(()=>e.keyboard&&d.value);Me({keydown:{ArrowUp:{prevent:!0,handler:V},ArrowRight:{prevent:!0,handler:G},ArrowDown:{prevent:!0,handler:A},ArrowLeft:{prevent:!0,handler:q},Escape:U},keyup:{Enter:W}},$);const{mergedClsPrefixRef:F,inlineThemeDisabled:C}=Pe(e),z=ie("Dropdown","-dropdown",qe,Ke,e,F);Z(H,{labelFieldRef:D(e,"labelField"),childrenFieldRef:D(e,"childrenField"),renderLabelRef:D(e,"renderLabel"),renderIconRef:D(e,"renderIcon"),hoverKeyRef:u,keyboardKeyRef:p,lastToggledSubmenuKeyRef:f,pendingKeyPathRef:b,activeKeyPathRef:g,animatedRef:D(e,"animated"),mergedShowRef:d,doSelect:O,doUpdateShow:x}),Ie(d,a=>{a||L()});function O(a,n){const{onSelect:r}=e;r&&Y(r,a,n)}function x(a){const{"onUpdate:show":n,onUpdateShow:r}=e;n&&Y(n,a),r&&Y(r,a),t.value=a}function L(){u.value=null,p.value=null,f.value=null}function U(){x(!1)}function q(){R("left")}function G(){R("right")}function V(){R("up")}function A(){R("down")}function W(){const a=M();a!=null&&a.isLeaf&&(O(a.key,a.rawNode),x(!1))}function M(){var a;const{value:n}=i,{value:r}=w;return!n||r===null?null:(a=n.getNode(r))!==null&&a!==void 0?a:null}function R(a){const{value:n}=w,{value:{getFirstAvailableNode:r}}=i;let l=null;if(n===null){const h=r();h!==null&&(l=h.key)}else{const h=M();if(h){let y;switch(a){case"down":y=h.getNext();break;case"up":y=h.getPrev();break;case"right":y=h.getChild();break;case"left":y=h.getParent();break}y&&(l=y.key)}}l!==null&&(u.value=null,p.value=l)}const j=v(()=>{const{size:a,inverted:n}=e,{common:{cubicBezierEaseInOut:r},self:l}=z.value,{padding:h,dividerColor:y,borderRadius:k,optionOpacityDisabled:ue,[K("optionIconSuffixWidth",a)]:ce,[K("optionSuffixWidth",a)]:pe,[K("optionIconPrefixWidth",a)]:fe,[K("optionPrefixWidth",a)]:he,[K("fontSize",a)]:ve,[K("optionHeight",a)]:we,[K("optionIconSize",a)]:be}=l,c={"--n-bezier":r,"--n-font-size":ve,"--n-padding":h,"--n-border-radius":k,"--n-option-height":we,"--n-option-prefix-width":he,"--n-option-icon-prefix-width":fe,"--n-option-suffix-width":pe,"--n-option-icon-suffix-width":ce,"--n-option-icon-size":be,"--n-divider-color":y,"--n-option-opacity-disabled":ue};return n?(c["--n-color"]=l.colorInverted,c["--n-option-color-hover"]=l.optionColorHoverInverted,c["--n-option-color-active"]=l.optionColorActiveInverted,c["--n-option-text-color"]=l.optionTextColorInverted,c["--n-option-text-color-hover"]=l.optionTextColorHoverInverted,c["--n-option-text-color-active"]=l.optionTextColorActiveInverted,c["--n-option-text-color-child-active"]=l.optionTextColorChildActiveInverted,c["--n-prefix-color"]=l.prefixColorInverted,c["--n-suffix-color"]=l.suffixColorInverted,c["--n-group-header-text-color"]=l.groupHeaderTextColorInverted):(c["--n-color"]=l.color,c["--n-option-color-hover"]=l.optionColorHover,c["--n-option-color-active"]=l.optionColorActive,c["--n-option-text-color"]=l.optionTextColor,c["--n-option-text-color-hover"]=l.optionTextColorHover,c["--n-option-text-color-active"]=l.optionTextColorActive,c["--n-option-text-color-child-active"]=l.optionTextColorChildActive,c["--n-prefix-color"]=l.prefixColor,c["--n-suffix-color"]=l.suffixColor,c["--n-group-header-text-color"]=l.groupHeaderTextColor),c}),S=C?Ce("dropdown",v(()=>`${e.size[0]}${e.inverted?"i":""}`),j,e):void 0;return{mergedClsPrefix:F,mergedTheme:z,tmNodes:o,mergedShow:d,doUpdateShow:x,cssVars:C?void 0:j,themeClass:S==null?void 0:S.themeClass,onRender:S==null?void 0:S.onRender}},render(){const e=(i,o,u,p,f)=>{var w;const{mergedClsPrefix:b}=this;(w=this.onRender)===null||w===void 0||w.call(this);const g={ref:je(o),class:[i,`${b}-dropdown`,this.themeClass,this.trigger==="manual"&&`${b}-popover--manual-trigger`,this.showArrow&&`${b}-popover--show-arrow`],clsPrefix:b,tmNodes:this.tmNodes,style:[u,this.cssVars],showArrow:this.showArrow,arrowStyle:this.arrowStyle,onMouseenter:p,onMouseleave:f};return s(se,te(this.$attrs,g))},{mergedTheme:t}=this,d={show:this.mergedShow,theme:t.peers.Popover,themeOverrides:t.peerOverrides.Popover,internalRenderBody:e,onUpdateShow:this.doUpdateShow};return s(ge,Object.assign({},De(this.$props,Ve),d),{trigger:()=>{var i,o;return(o=(i=this.$slots).default)===null||o===void 0?void 0:o.call(i)}})}});export{ro as N};
